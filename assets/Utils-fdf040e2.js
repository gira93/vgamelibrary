import{d as rt,P as kt,X as Ue,_ as jt}from"./PlatformRepository-3abe7ed2.js";import{G as St}from"./GameRepository-4251035f.js";import{d as xt,r as Ot,h as st,b as Ae,k as ut,c as Lt,w as Rt,F as Ut,a as at}from"./index-0f5e497a.js";const Ft=g=>{const d=["name","platform"],s=g.map(b=>{var m;return[`"${b.name}"`,`"${(m=b.platform)==null?void 0:m.name}"`]});return d+`
`+s.map(b=>b.join(",")).join(`
`)},Dt=g=>Array.from(new Set(g.map(s=>{var b;return((b=s.platform)==null?void 0:b.name)||""}))).map(s=>({name:s})),Kt=async g=>{await rt.delete(),await rt.open();const d=new kt,s=new St,b=Dt(g);try{return await d.bulkCreate(b),await Promise.all(g.map(async m=>{var o,N;let c=null;if((o=m.platform)!=null&&o.name&&(c=await d.getByName((N=m.platform)==null?void 0:N.name)),m.name&&(c!=null&&c.id))return await s.create({name:m.name,platformId:c.id});throw Error("Game name or platform not found")})),!0}catch(m){throw m.message}};class $t{downloadGamesCsv(d){const s=Ft(d),b=new Blob([s],{type:"text/csv"}),m=document.createElement("a");m.setAttribute("href",window.URL.createObjectURL(b)),m.setAttribute("download","games.csv"),document.body.appendChild(m),m.click()}importGamesCsv(d){const b=d.slice(d.indexOf(`
`)+1).split(/\r?\n/).map(m=>{const c=m.split('","');return{name:c[0].replace('"',""),platform:{name:c[1].replace('"',"")}}});return Kt(b)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function tt(g,d,s,b){function m(c){return c instanceof s?c:new s(function(o){o(c)})}return new(s||(s=Promise))(function(c,o){function N(E){try{u(b.next(E))}catch(I){o(I)}}function L(E){try{u(b.throw(E))}catch(I){o(I)}}function u(E){E.done?c(E.value):m(E.value).then(N,L)}u((b=b.apply(g,d||[])).next())})}function Xe(g,d){var s={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},b,m,c,o;return o={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function N(u){return function(E){return L([u,E])}}function L(u){if(b)throw new TypeError("Generator is already executing.");for(;s;)try{if(b=1,m&&(c=u[0]&2?m.return:u[0]?m.throw||((c=m.return)&&c.call(m),0):m.next)&&!(c=c.call(m,u[1])).done)return c;switch(m=0,c&&(u=[u[0]&2,c.value]),u[0]){case 0:case 1:c=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,m=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(c=s.trys,!(c=c.length>0&&c[c.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!c||u[1]>c[0]&&u[1]<c[3])){s.label=u[1];break}if(u[0]===6&&s.label<c[1]){s.label=c[1],c=u;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(u);break}c[2]&&s.ops.pop(),s.trys.pop();continue}u=d.call(g,s)}catch(E){u=[6,E],m=0}finally{b=c=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Jt(g){var d=[g.schema.primKey].concat(g.schema.indexes);return d.map(function(s){return s.src}).join(",")}function Vt(g){for(var d={},s=0,b=g.tables;s<b.length;s++){var m=b[s];d[m.name]=m.schema}return d}function At(g,d){return new Promise(function(s,b){var m=new FileReader;m.onabort=function(c){return b(new Error("file read aborted"))},m.onerror=function(c){return b(c.target.error)},m.onload=function(c){return s(c.target.result)},d==="binary"?m.readAsArrayBuffer(g):m.readAsText(g)})}function Tt(g,d){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var s=new FileReaderSync,b=d==="binary"?s.readAsArrayBuffer(g):s.readAsText(g);return b}var bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wt(g,d){return d={exports:{}},g(d,d.exports),d.exports}var dt=wt(function(g,d){(function(s,b){g.exports=b()})(bt,function(){function s(l){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=function(y){return typeof y}:s=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},s(l)}function b(l,y,v,h,A,Y,X){try{var Q=l[Y](X),j=Q.value}catch(Te){v(Te);return}Q.done?y(j):Promise.resolve(j).then(h,A)}function m(l){return function(){var y=this,v=arguments;return new Promise(function(h,A){var Y=l.apply(y,v);function X(j){b(Y,h,A,X,Q,"next",j)}function Q(j){b(Y,h,A,X,Q,"throw",j)}X(void 0)})}}function c(l,y){if(!(l instanceof y))throw new TypeError("Cannot call a class as a function")}function o(l,y){for(var v=0;v<y.length;v++){var h=y[v];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(l,h.key,h)}}function N(l,y,v){return y&&o(l.prototype,y),v&&o(l,v),l}function L(l,y,v){return y in l?Object.defineProperty(l,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):l[y]=v,l}function u(l,y){var v=Object.keys(l);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(l);y&&(h=h.filter(function(A){return Object.getOwnPropertyDescriptor(l,A).enumerable})),v.push.apply(v,h)}return v}function E(l){for(var y=1;y<arguments.length;y++){var v=arguments[y]!=null?arguments[y]:{};y%2?u(Object(v),!0).forEach(function(h){L(l,h,v[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(v)):u(Object(v)).forEach(function(h){Object.defineProperty(l,h,Object.getOwnPropertyDescriptor(v,h))})}return l}function I(l,y){return K(l)||z(l,y)||be()}function V(l){return fe(l)||D(l)||_e()}function fe(l){if(Array.isArray(l)){for(var y=0,v=new Array(l.length);y<l.length;y++)v[y]=l[y];return v}}function K(l){if(Array.isArray(l))return l}function D(l){if(Symbol.iterator in Object(l)||Object.prototype.toString.call(l)==="[object Arguments]")return Array.from(l)}function z(l,y){if(Symbol.iterator in Object(l)||Object.prototype.toString.call(l)==="[object Arguments]"){var v=[],h=!0,A=!1,Y=void 0;try{for(var X=l[Symbol.iterator](),Q;!(h=(Q=X.next()).done)&&(v.push(Q.value),!(y&&v.length===y));h=!0);}catch(j){A=!0,Y=j}finally{try{!h&&X.return!=null&&X.return()}finally{if(A)throw Y}}return v}}function _e(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function be(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var C=function l(y){c(this,l),this.p=new Promise(y)};C.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(C.prototype[Symbol.toStringTag]="TypesonPromise"),C.prototype.then=function(l,y){var v=this;return new C(function(h,A){v.p.then(function(Y){h(l?l(Y):Y)}).catch(function(Y){return y?y(Y):Promise.reject(Y)}).then(h,A)})},C.prototype.catch=function(l){return this.then(null,l)},C.resolve=function(l){return new C(function(y){y(l)})},C.reject=function(l){return new C(function(y,v){v(l)})},["all","race"].forEach(function(l){C[l]=function(y){return new C(function(v,h){Promise[l](y.map(function(A){return A&&A.constructor&&A.constructor.__typeson__type__==="TypesonPromise"?A.p:A})).then(v,h)})}});var Ce={},$=Ce.toString,re={}.hasOwnProperty,ie=Object.getPrototypeOf,Pe=re.toString;function f(l,y){return M(l)&&typeof l.then=="function"&&(!y||typeof l.catch=="function")}function r(l){return $.call(l).slice(8,-1)}function w(l,y){if(!l||s(l)!=="object")return!1;var v=ie(l);if(!v)return y===null;var h=re.call(v,"constructor")&&v.constructor;return typeof h!="function"?y===null:y===h||y!==null&&Pe.call(h)===Pe.call(y)||typeof y=="function"&&typeof h.__typeson__type__=="string"&&h.__typeson__type__===y.__typeson__type__}function p(l){if(!l||r(l)!=="Object")return!1;var y=ie(l);return y?w(l,Object):!0}function te(l){if(!l||r(l)!=="Object")return!1;var y=ie(l);return y?w(l,Object)||te(y):!0}function M(l){return l&&s(l)==="object"}function ae(l){return l.replace(/~/g,"~0").replace(/\./g,"~1")}function he(l){return l.replace(/~1/g,".").replace(/~0/g,"~")}function Se(l,y){if(y==="")return l;var v=y.indexOf(".");if(v>-1){var h=l[he(y.slice(0,v))];return h===void 0?void 0:Se(h,y.slice(v+1))}return l[he(y)]}function ke(l,y,v){if(y==="")return v;var h=y.indexOf(".");if(h>-1){var A=l[he(y.slice(0,h))];return ke(A,y.slice(h+1),v)}return l[he(y)]=v,l}function Ne(l){return l===null?"null":Array.isArray(l)?"array":s(l)}var le=Object.keys,me=Array.isArray,je={}.hasOwnProperty,Me=["type","replaced","iterateIn","iterateUnsetNumeric"];function J(l,y){if(l.keypath==="")return-1;var v=l.keypath.match(/\./g)||0,h=y.keypath.match(/\./g)||0;return v&&(v=v.length),h&&(h=h.length),v>h?-1:v<h?1:l.keypath<y.keypath?-1:l.keypath>y.keypath}var de=function(){function l(y){c(this,l),this.options=y,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return N(l,[{key:"stringify",value:function(v,h,A,Y){Y=E({},this.options,{},Y,{stringification:!0});var X=this.encapsulate(v,null,Y);return me(X)?JSON.stringify(X[0],h,A):X.then(function(Q){return JSON.stringify(Q,h,A)})}},{key:"stringifySync",value:function(v,h,A,Y){return this.stringify(v,h,A,E({throwOnBadSyncType:!0},Y,{sync:!0}))}},{key:"stringifyAsync",value:function(v,h,A,Y){return this.stringify(v,h,A,E({throwOnBadSyncType:!0},Y,{sync:!1}))}},{key:"parse",value:function(v,h,A){return A=E({},this.options,{},A,{parse:!0}),this.revive(JSON.parse(v,h),A)}},{key:"parseSync",value:function(v,h,A){return this.parse(v,h,E({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"parseAsync",value:function(v,h,A){return this.parse(v,h,E({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"specialTypeNames",value:function(v,h){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.returnTypeNames=!0,this.encapsulate(v,h,A)}},{key:"rootTypeName",value:function(v,h){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.iterateNone=!0,this.encapsulate(v,h,A)}},{key:"encapsulate",value:function(v,h,A){A=E({sync:!0},this.options,{},A);var Y=A,X=Y.sync,Q=this,j={},Te=[],Le=[],Fe=[],Ye="cyclic"in A?A.cyclic:!0,qe=A,Qe=qe.encapsulateObserver,De=ue("",v,Ye,h||{},Fe);function ze(B){var n=Object.values(j);if(A.iterateNone)return n.length?n[0]:l.getJSONType(B);if(n.length){if(A.returnTypeNames)return V(new Set(n));!B||!p(B)||je.call(B,"$types")?B={$:B,$types:{$:j}}:B.$types=j}else M(B)&&je.call(B,"$types")&&(B={$:B,$types:!0});return A.returnTypeNames?!1:B}function ge(B,n){return se.apply(this,arguments)}function se(){return se=m(regeneratorRuntime.mark(function B(n,e){var t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(e.map(function(O){return O[1].p}));case 2:return t=a.sent,a.next=5,Promise.all(t.map(function(){var O=m(regeneratorRuntime.mark(function T(k){var _,U,q,H,oe,ee,Z,pe,ye,G,Ee,P,S,R;return regeneratorRuntime.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(_=[],U=e.splice(0,1),q=I(U,1),H=q[0],oe=I(H,7),ee=oe[0],Z=oe[2],pe=oe[3],ye=oe[4],G=oe[5],Ee=oe[6],P=ue(ee,k,Z,pe,_,!0,Ee),S=w(P,C),!(ee&&S)){F.next=11;break}return F.next=8,P.p;case 8:return R=F.sent,ye[G]=R,F.abrupt("return",ge(n,_));case 11:return ee?ye[G]=P:S?n=P.p:n=P,F.abrupt("return",ge(n,_));case 13:case"end":return F.stop()}},T)}));return function(T){return O.apply(this,arguments)}}()));case 5:return a.abrupt("return",n);case 6:case"end":return a.stop()}},B)})),se.apply(this,arguments)}function ne(B,n,e){Object.assign(B,n);var t=Me.map(function(i){var a=B[i];return delete B[i],a});e(),Me.forEach(function(i,a){B[i]=t[a]})}function ue(B,n,e,t,i,a,O){var T,k={},_=s(n),U=Qe?function(S){var R=O||t.type||l.getJSONType(n);Qe(Object.assign(S||k,{keypath:B,value:n,cyclic:e,stateObj:t,promisesData:i,resolvingTypesonPromise:a,awaitingTypesonPromise:w(n,C)},{type:R}))}:null;if(["string","boolean","number","undefined"].includes(_))return n===void 0||_==="number"&&(isNaN(n)||n===-1/0||n===1/0)?(t.replaced?T=n:T=we(B,n,t,i,!1,a,U),T!==n&&(k={replaced:T})):T=n,U&&U(),T;if(n===null)return U&&U(),n;if(e&&!t.iterateIn&&!t.iterateUnsetNumeric&&n&&s(n)==="object"){var q=Te.indexOf(n);if(q<0)e===!0&&(Te.push(n),Le.push(B));else return j[B]="#",U&&U({cyclicKeypath:Le[q]}),"#"+Le[q]}var H=p(n),oe=me(n),ee=(H||oe)&&(!Q.plainObjectReplacers.length||t.replaced)||t.iterateIn?n:we(B,n,t,i,H||oe,null,U),Z;if(ee!==n?(T=ee,k={replaced:ee}):B===""&&w(n,C)?(i.push([B,n,e,t,void 0,void 0,t.type]),T=n):oe&&t.iterateIn!=="object"||t.iterateIn==="array"?(Z=new Array(n.length),k={clone:Z}):!["function","symbol"].includes(s(n))&&!("toJSON"in n)&&!w(n,C)&&!w(n,Promise)&&!w(n,ArrayBuffer)||H||t.iterateIn==="object"?(Z={},t.addLength&&(Z.length=n.length),k={clone:Z}):T=n,U&&U(),A.iterateNone)return Z||T;if(!Z)return T;if(t.iterateIn){var pe=function(R){var x={ownKeys:je.call(n,R)};ne(t,x,function(){var F=B+(B?".":"")+ae(R),W=ue(F,n[R],!!e,t,i,a);w(W,C)?i.push([F,W,!!e,t,Z,R,t.type]):W!==void 0&&(Z[R]=W)})};for(var ye in n)pe(ye);U&&U({endIterateIn:!0,end:!0})}else le(n).forEach(function(S){var R=B+(B?".":"")+ae(S),x={ownKeys:!0};ne(t,x,function(){var F=ue(R,n[S],!!e,t,i,a);w(F,C)?i.push([R,F,!!e,t,Z,S,t.type]):F!==void 0&&(Z[S]=F)})}),U&&U({endIterateOwn:!0,end:!0});if(t.iterateUnsetNumeric){for(var G=n.length,Ee=function(R){if(!(R in n)){var x=B+(B?".":"")+R,F={ownKeys:!1};ne(t,F,function(){var W=ue(x,void 0,!!e,t,i,a);w(W,C)?i.push([x,W,!!e,t,Z,R,t.type]):W!==void 0&&(Z[R]=W)})}},P=0;P<G;P++)Ee(P);U&&U({endIterateUnsetNumeric:!0,end:!0})}return Z}function we(B,n,e,t,i,a,O){for(var T=i?Q.plainObjectReplacers:Q.nonplainObjectReplacers,k=T.length;k--;){var _=T[k];if(_.test(n,e)){var U=_.type;if(Q.revivers[U]){var q=j[B];j[B]=q?[U].concat(q):U}if(Object.assign(e,{type:U,replaced:!0}),(X||!_.replaceAsync)&&!_.replace)return O&&O({typeDetected:!0}),ue(B,n,Ye&&"readonly",e,t,a,U);O&&O({replacing:!0});var H=X||!_.replaceAsync?"replace":"replaceAsync";return ue(B,_[H](n,e),Ye&&"readonly",e,t,a,U)}}return n}return Fe.length?X&&A.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(ge(De,Fe)).then(ze):!X&&A.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():A.stringification&&X?[ze(De)]:X?ze(De):Promise.resolve(ze(De))}},{key:"encapsulateSync",value:function(v,h,A){return this.encapsulate(v,h,E({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"encapsulateAsync",value:function(v,h,A){return this.encapsulate(v,h,E({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"revive",value:function(v,h){var A=v&&v.$types;if(!A)return v;if(A===!0)return v.$;h=E({sync:!0},this.options,{},h);var Y=h,X=Y.sync,Q=[],j={},Te=!0;A.$&&p(A.$)&&(v=v.$,A=A.$,Te=!1);var Le=this;function Fe(se,ne){var ue=Le.revivers[se]||[],we=I(ue,1),B=we[0];if(!B)throw new Error("Unregistered type: "+se);return X&&!("revive"in B)?ne:B[X&&B.revive?"revive":!X&&B.reviveAsync?"reviveAsync":"revive"](ne,j)}function Ye(){var se=[];if(Object.entries(A).forEach(function(ne){var ue=I(ne,2),we=ue[0],B=ue[1];B!=="#"&&[].concat(B).forEach(function(n){var e=Le.revivers[n]||[null,{}],t=I(e,2),i=t[1].plain;i&&(se.push({keypath:we,type:n}),delete A[we])})}),!!se.length)return se.sort(J).reduce(function ne(ue,we){var B=we.keypath,n=we.type;if(f(ue))return ue.then(function(i){return ne(i,{keypath:B,type:n})});var e=Se(v,B);if(e=Fe(n,e),w(e,C))return e.then(function(i){var a=ke(v,B,i);a===i&&(v=a)});var t=ke(v,B,e);t===e&&(v=t)},void 0)}var qe=[];function Qe(se,ne,ue,we,B){if(!(Te&&se==="$types")){var n=A[se],e=me(ne);if(e||p(ne)){var t=e?new Array(ne.length):{};for(le(ne).forEach(function(q){var H=Qe(se+(se?".":"")+ae(q),ne[q],ue||t,t,q),oe=function(Z){return w(Z,xe)?t[q]=void 0:Z!==void 0&&(t[q]=Z),Z};w(H,C)?qe.push(H.then(function(ee){return oe(ee)})):oe(H)}),ne=t;Q.length;){var i=I(Q[0],4),a=i[0],O=i[1],T=i[2],k=i[3],_=Se(a,O);if(_!==void 0)T[k]=_;else break;Q.splice(0,1)}}if(!n)return ne;if(n==="#"){var U=Se(ue,ne.slice(1));return U===void 0&&Q.push([ue,ne.slice(1),we,B]),U}return[].concat(n).reduce(function q(H,oe){return w(H,C)?H.then(function(ee){return q(ee,oe)}):Fe(oe,H)},ne)}}function De(se){return w(se,xe)?void 0:se}var ze=Ye(),ge;return w(ze,C)?ge=ze.then(function(){return v}):(ge=Qe("",v,null),qe.length&&(ge=C.resolve(ge).then(function(se){return C.all([se].concat(qe))}).then(function(se){var ne=I(se,1),ue=ne[0];return ue}))),f(ge)?X&&h.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():w(ge,C)?ge.p.then(De):ge:!X&&h.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():X?De(ge):Promise.resolve(De(ge))}},{key:"reviveSync",value:function(v,h){return this.revive(v,E({throwOnBadSyncType:!0},h,{sync:!0}))}},{key:"reviveAsync",value:function(v,h){return this.revive(v,E({throwOnBadSyncType:!0},h,{sync:!1}))}},{key:"register",value:function(v,h){return h=h||{},[].concat(v).forEach(function A(Y){var X=this;if(me(Y))return Y.map(function(Q){return A.call(X,Q)});Y&&le(Y).forEach(function(Q){if(Q==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(l.JSON_TYPES.includes(Q))throw new TypeError("Plain JSON object types are reserved as type names");var j=Y[Q],Te=j&&j.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Le=Te.filter(function(ue){return ue.type===Q});if(Le.length&&(Te.splice(Te.indexOf(Le[0]),1),delete this.revivers[Q],delete this.types[Q]),typeof j=="function"){var Fe=j;j={test:function(we){return we&&we.constructor===Fe},replace:function(we){return E({},we)},revive:function(we){return Object.assign(Object.create(Fe.prototype),we)}}}else if(me(j)){var Ye=j,qe=I(Ye,3),Qe=qe[0],De=qe[1],ze=qe[2];j={test:Qe,replace:De,revive:ze}}if(!(!j||!j.test)){var ge={type:Q,test:j.test.bind(j)};j.replace&&(ge.replace=j.replace.bind(j)),j.replaceAsync&&(ge.replaceAsync=j.replaceAsync.bind(j));var se=typeof h.fallback=="number"?h.fallback:h.fallback?0:1/0;if(j.testPlainObjects?this.plainObjectReplacers.splice(se,0,ge):this.nonplainObjectReplacers.splice(se,0,ge),j.revive||j.reviveAsync){var ne={};j.revive&&(ne.revive=j.revive.bind(j)),j.reviveAsync&&(ne.reviveAsync=j.reviveAsync.bind(j)),this.revivers[Q]=[ne,{plain:j.testPlainObjects}]}this.types[Q]=j}},this)},this),this}}]),l}(),xe=function l(){c(this,l)};return xe.__typeson__type__="TypesonUndefined",de.Undefined=xe,de.Promise=C,de.isThenable=f,de.toStringTag=r,de.hasConstructorOf=w,de.isObject=M,de.isPlainObject=p,de.isUserObject=te,de.escapeKeyPathComponent=ae,de.unescapeKeyPathComponent=he,de.getByKeyPath=Se,de.getJSONType=Ne,de.JSON_TYPES=["null","boolean","number","string","array","object"],de})}),Gt=wt(function(g,d){(function(s,b){g.exports=b()})(bt,function(){function s(n){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function b(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function m(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function c(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function N(n){return function(t){if(Array.isArray(t))return L(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,i){if(t){if(typeof t=="string")return L(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return L(t,i)}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function L(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function u(n){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function E(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function I(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function V(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fe(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function K(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?fe(Object(t),!0).forEach(function(i){V(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):fe(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function D(n,e){return function(i){if(Array.isArray(i))return i}(n)||function(i,a){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var O=[],T=!0,k=!1,_=void 0;try{for(var U,q=i[Symbol.iterator]();!(T=(U=q.next()).done)&&(O.push(U.value),!a||O.length!==a);T=!0);}catch(H){k=!0,_=H}finally{try{T||q.return==null||q.return()}finally{if(k)throw _}}return O}}(n,e)||_e(n,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function z(n){return function(t){if(Array.isArray(t))return be(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||_e(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function _e(n,e){if(n){if(typeof n=="string")return be(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?be(n,e):void 0}}function be(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}var C=function n(e){E(this,n),this.p=new Promise(e)};C.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(C.prototype[Symbol.toStringTag]="TypesonPromise"),C.prototype.then=function(n,e){var t=this;return new C(function(i,a){t.p.then(function(O){i(n?n(O):O)}).catch(function(O){return e?e(O):Promise.reject(O)}).then(i,a)})},C.prototype.catch=function(n){return this.then(null,n)},C.resolve=function(n){return new C(function(e){e(n)})},C.reject=function(n){return new C(function(e,t){t(n)})},["all","race"].forEach(function(n){C[n]=function(e){return new C(function(t,i){Promise[n](e.map(function(a){return a&&a.constructor&&a.constructor.__typeson__type__==="TypesonPromise"?a.p:a})).then(t,i)})}});var Ce={}.toString,$={}.hasOwnProperty,re=Object.getPrototypeOf,ie=$.toString;function Pe(n,e){return p(n)&&typeof n.then=="function"&&(!e||typeof n.catch=="function")}function f(n){return Ce.call(n).slice(8,-1)}function r(n,e){if(!n||u(n)!=="object")return!1;var t=re(n);if(!t)return e===null;var i=$.call(t,"constructor")&&t.constructor;return typeof i!="function"?e===null:e===i||e!==null&&ie.call(i)===ie.call(e)||typeof e=="function"&&typeof i.__typeson__type__=="string"&&i.__typeson__type__===e.__typeson__type__}function w(n){return!(!n||f(n)!=="Object")&&(!re(n)||r(n,Object))}function p(n){return n&&u(n)==="object"}function te(n){return n.replace(/~/g,"~0").replace(/\./g,"~1")}function M(n){return n.replace(/~1/g,".").replace(/~0/g,"~")}function ae(n,e){if(e==="")return n;var t=e.indexOf(".");if(t>-1){var i=n[M(e.slice(0,t))];return i===void 0?void 0:ae(i,e.slice(t+1))}return n[M(e)]}function he(n,e,t){if(e==="")return t;var i=e.indexOf(".");return i>-1?he(n[M(e.slice(0,i))],e.slice(i+1),t):(n[M(e)]=t,n)}function Se(n,e,t){return t?e?e(n):n:(n&&n.then||(n=Promise.resolve(n)),e?n.then(e):n)}var ke=Object.keys,Ne=Array.isArray,le={}.hasOwnProperty,me=["type","replaced","iterateIn","iterateUnsetNumeric"];function je(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(i){return Promise.reject(i)}}}function Me(n,e){if(n.keypath==="")return-1;var t=n.keypath.match(/\./g)||0,i=e.keypath.match(/\./g)||0;return t&&(t=t.length),i&&(i=i.length),t>i?-1:t<i?1:n.keypath<e.keypath?-1:n.keypath>e.keypath}var J=function(){function n(e){E(this,n),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(t,i,a){return i&&I(t.prototype,i),a&&I(t,a),t}(n,[{key:"stringify",value:function(t,i,a,O){O=K(K(K({},this.options),O),{},{stringification:!0});var T=this.encapsulate(t,null,O);return Ne(T)?JSON.stringify(T[0],i,a):T.then(function(k){return JSON.stringify(k,i,a)})}},{key:"stringifySync",value:function(t,i,a,O){return this.stringify(t,i,a,K(K({throwOnBadSyncType:!0},O),{},{sync:!0}))}},{key:"stringifyAsync",value:function(t,i,a,O){return this.stringify(t,i,a,K(K({throwOnBadSyncType:!0},O),{},{sync:!1}))}},{key:"parse",value:function(t,i,a){return a=K(K(K({},this.options),a),{},{parse:!0}),this.revive(JSON.parse(t,i),a)}},{key:"parseSync",value:function(t,i,a){return this.parse(t,i,K(K({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"parseAsync",value:function(t,i,a){return this.parse(t,i,K(K({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"specialTypeNames",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.returnTypeNames=!0,this.encapsulate(t,i,a)}},{key:"rootTypeName",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.iterateNone=!0,this.encapsulate(t,i,a)}},{key:"encapsulate",value:function(t,i,a){var O=je(function(P,S){return Se(Promise.all(S.map(function(R){return R[1].p})),function(R){return Se(Promise.all(R.map(je(function(x){var F=!1,W=[],Ke=D(S.splice(0,1),1),Oe=D(Ke[0],7),Re=Oe[0],Je=Oe[2],ce=Oe[3],Ve=Oe[4],ve=Oe[5],$e=Oe[6],Be=G(Re,x,Je,ce,W,!0,$e),He=r(Be,C);return function(vt,ft){var it=vt();return it&&it.then?it.then(ft):ft(it)}(function(){if(Re&&He)return Se(Be.p,function(We){return Ve[ve]=We,F=!0,O(P,W)})},function(We){return F?We:(Re?Ve[ve]=Be:P=He?Be.p:Be,O(P,W))})}))),function(){return P})})}),T=(a=K(K({sync:!0},this.options),a)).sync,k=this,_={},U=[],q=[],H=[],oe=!("cyclic"in a)||a.cyclic,ee=a.encapsulateObserver,Z=G("",t,oe,i||{},H);function pe(P){var S=Object.values(_);if(a.iterateNone)return S.length?S[0]:n.getJSONType(P);if(S.length){if(a.returnTypeNames)return z(new Set(S));P&&w(P)&&!le.call(P,"$types")?P.$types=_:P={$:P,$types:{$:_}}}else p(P)&&le.call(P,"$types")&&(P={$:P,$types:!0});return!a.returnTypeNames&&P}function ye(P,S,R){Object.assign(P,S);var x=me.map(function(F){var W=P[F];return delete P[F],W});R(),me.forEach(function(F,W){P[F]=x[W]})}function G(P,S,R,x,F,W,Ke){var Oe,Re={},Je=u(S),ce=ee?function(et){var Ie=Ke||x.type||n.getJSONType(S);ee(Object.assign(et||Re,{keypath:P,value:S,cyclic:R,stateObj:x,promisesData:F,resolvingTypesonPromise:W,awaitingTypesonPromise:r(S,C)},{type:Ie}))}:null;if(["string","boolean","number","undefined"].includes(Je))return S===void 0||Number.isNaN(S)||S===Number.NEGATIVE_INFINITY||S===Number.POSITIVE_INFINITY?(Oe=x.replaced?S:Ee(P,S,x,F,!1,W,ce))!==S&&(Re={replaced:Oe}):Oe=S,ce&&ce(),Oe;if(S===null)return ce&&ce(),S;if(R&&!x.iterateIn&&!x.iterateUnsetNumeric&&S&&u(S)==="object"){var Ve=U.indexOf(S);if(!(Ve<0))return _[P]="#",ce&&ce({cyclicKeypath:q[Ve]}),"#"+q[Ve];R===!0&&(U.push(S),q.push(P))}var ve,$e=w(S),Be=Ne(S),He=($e||Be)&&(!k.plainObjectReplacers.length||x.replaced)||x.iterateIn?S:Ee(P,S,x,F,$e||Be,null,ce);if(He!==S?(Oe=He,Re={replaced:He}):P===""&&r(S,C)?(F.push([P,S,R,x,void 0,void 0,x.type]),Oe=S):Be&&x.iterateIn!=="object"||x.iterateIn==="array"?(ve=new Array(S.length),Re={clone:ve}):(["function","symbol"].includes(u(S))||"toJSON"in S||r(S,C)||r(S,Promise)||r(S,ArrayBuffer))&&!$e&&x.iterateIn!=="object"?Oe=S:(ve={},x.addLength&&(ve.length=S.length),Re={clone:ve}),ce&&ce(),a.iterateNone)return ve||Oe;if(!ve)return Oe;if(x.iterateIn){var We=function(Ie){var Ze={ownKeys:le.call(S,Ie)};ye(x,Ze,function(){var nt=P+(P?".":"")+te(Ie),lt=G(nt,S[Ie],!!R,x,F,W);r(lt,C)?F.push([nt,lt,!!R,x,ve,Ie,x.type]):lt!==void 0&&(ve[Ie]=lt)})};for(var vt in S)We(vt);ce&&ce({endIterateIn:!0,end:!0})}else ke(S).forEach(function(et){var Ie=P+(P?".":"")+te(et);ye(x,{ownKeys:!0},function(){var Ze=G(Ie,S[et],!!R,x,F,W);r(Ze,C)?F.push([Ie,Ze,!!R,x,ve,et,x.type]):Ze!==void 0&&(ve[et]=Ze)})}),ce&&ce({endIterateOwn:!0,end:!0});if(x.iterateUnsetNumeric){for(var ft=S.length,it=function(Ie){if(!(Ie in S)){var Ze=P+(P?".":"")+Ie;ye(x,{ownKeys:!1},function(){var nt=G(Ze,void 0,!!R,x,F,W);r(nt,C)?F.push([Ze,nt,!!R,x,ve,Ie,x.type]):nt!==void 0&&(ve[Ie]=nt)})}},ht=0;ht<ft;ht++)it(ht);ce&&ce({endIterateUnsetNumeric:!0,end:!0})}return ve}function Ee(P,S,R,x,F,W,Ke){for(var Oe=F?k.plainObjectReplacers:k.nonplainObjectReplacers,Re=Oe.length;Re--;){var Je=Oe[Re];if(Je.test(S,R)){var ce=Je.type;if(k.revivers[ce]){var Ve=_[P];_[P]=Ve?[ce].concat(Ve):ce}return Object.assign(R,{type:ce,replaced:!0}),!T&&Je.replaceAsync||Je.replace?(Ke&&Ke({replacing:!0}),G(P,Je[T||!Je.replaceAsync?"replace":"replaceAsync"](S,R),oe&&"readonly",R,x,W,ce)):(Ke&&Ke({typeDetected:!0}),G(P,S,oe&&"readonly",R,x,W,ce))}}return S}return H.length?T&&a.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(O(Z,H)).then(pe):!T&&a.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():a.stringification&&T?[pe(Z)]:T?pe(Z):Promise.resolve(pe(Z))}},{key:"encapsulateSync",value:function(t,i,a){return this.encapsulate(t,i,K(K({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(t,i,a){return this.encapsulate(t,i,K(K({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"revive",value:function(t,i){var a=t&&t.$types;if(!a)return t;if(a===!0)return t.$;var O=(i=K(K({sync:!0},this.options),i)).sync,T=[],k={},_=!0;a.$&&w(a.$)&&(t=t.$,a=a.$,_=!1);var U=this;function q(pe,ye){var G=D(U.revivers[pe]||[],1)[0];if(!G)throw new Error("Unregistered type: "+pe);return O&&!("revive"in G)?ye:G[O&&G.revive?"revive":!O&&G.reviveAsync?"reviveAsync":"revive"](ye,k)}var H=[];function oe(pe){return r(pe,de)?void 0:pe}var ee,Z=function(){var ye=[];if(Object.entries(a).forEach(function(G){var Ee=D(G,2),P=Ee[0],S=Ee[1];S!=="#"&&[].concat(S).forEach(function(R){D(U.revivers[R]||[null,{}],2)[1].plain&&(ye.push({keypath:P,type:R}),delete a[P])})}),ye.length)return ye.sort(Me).reduce(function G(Ee,P){var S=P.keypath,R=P.type;if(Pe(Ee))return Ee.then(function(W){return G(W,{keypath:S,type:R})});var x=ae(t,S);if(r(x=q(R,x),C))return x.then(function(W){var Ke=he(t,S,W);Ke===W&&(t=Ke)});var F=he(t,S,x);F===x&&(t=F)},void 0)}();return r(Z,C)?ee=Z.then(function(){return t}):(ee=function pe(ye,G,Ee,P,S){if(!_||ye!=="$types"){var R=a[ye],x=Ne(G);if(x||w(G)){var F=x?new Array(G.length):{};for(ke(G).forEach(function(ve){var $e=pe(ye+(ye?".":"")+te(ve),G[ve],Ee||F,F,ve),Be=function(We){return r(We,de)?F[ve]=void 0:We!==void 0&&(F[ve]=We),We};r($e,C)?H.push($e.then(function(He){return Be(He)})):Be($e)}),G=F;T.length;){var W=D(T[0],4),Ke=W[0],Oe=W[1],Re=W[2],Je=W[3],ce=ae(Ke,Oe);if(ce===void 0)break;Re[Je]=ce,T.splice(0,1)}}if(!R)return G;if(R==="#"){var Ve=ae(Ee,G.slice(1));return Ve===void 0&&T.push([Ee,G.slice(1),P,S]),Ve}return[].concat(R).reduce(function ve($e,Be){return r($e,C)?$e.then(function(He){return ve(He,Be)}):q(Be,$e)},G)}}("",t,null),H.length&&(ee=C.resolve(ee).then(function(pe){return C.all([pe].concat(H))}).then(function(pe){return D(pe,1)[0]}))),Pe(ee)?O&&i.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():r(ee,C)?ee.p.then(oe):ee:!O&&i.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():O?oe(ee):Promise.resolve(oe(ee))}},{key:"reviveSync",value:function(t,i){return this.revive(t,K(K({throwOnBadSyncType:!0},i),{},{sync:!0}))}},{key:"reviveAsync",value:function(t,i){return this.revive(t,K(K({throwOnBadSyncType:!0},i),{},{sync:!1}))}},{key:"register",value:function(t,i){return i=i||{},[].concat(t).forEach(function a(O){var T=this;if(Ne(O))return O.map(function(k){return a.call(T,k)});O&&ke(O).forEach(function(k){if(k==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(n.JSON_TYPES.includes(k))throw new TypeError("Plain JSON object types are reserved as type names");var _=O[k],U=_&&_.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,q=U.filter(function(ye){return ye.type===k});if(q.length&&(U.splice(U.indexOf(q[0]),1),delete this.revivers[k],delete this.types[k]),typeof _=="function"){var H=_;_={test:function(G){return G&&G.constructor===H},replace:function(G){return K({},G)},revive:function(G){return Object.assign(Object.create(H.prototype),G)}}}else if(Ne(_)){var oe=D(_,3);_={test:oe[0],replace:oe[1],revive:oe[2]}}if(_&&_.test){var ee={type:k,test:_.test.bind(_)};_.replace&&(ee.replace=_.replace.bind(_)),_.replaceAsync&&(ee.replaceAsync=_.replaceAsync.bind(_));var Z=typeof i.fallback=="number"?i.fallback:i.fallback?0:Number.POSITIVE_INFINITY;if(_.testPlainObjects?this.plainObjectReplacers.splice(Z,0,ee):this.nonplainObjectReplacers.splice(Z,0,ee),_.revive||_.reviveAsync){var pe={};_.revive&&(pe.revive=_.revive.bind(_)),_.reviveAsync&&(pe.reviveAsync=_.reviveAsync.bind(_)),this.revivers[k]=[pe,{plain:_.testPlainObjects}]}this.types[k]=_}},this)},this),this}}]),n}(),de=function n(){E(this,n)};de.__typeson__type__="TypesonUndefined",J.Undefined=de,J.Promise=C,J.isThenable=Pe,J.toStringTag=f,J.hasConstructorOf=r,J.isObject=p,J.isPlainObject=w,J.isUserObject=function n(e){if(!e||f(e)!=="Object")return!1;var t=re(e);return!t||r(e,Object)||n(t)},J.escapeKeyPathComponent=te,J.unescapeKeyPathComponent=M,J.getByKeyPath=ae,J.getJSONType=function(e){return e===null?"null":Array.isArray(e)?"array":u(e)},J.JSON_TYPES=["null","boolean","number","string","array","object"];for(var xe={userObject:{test:function(e,t){return J.isUserObject(e)},replace:function(e){return function(i){for(var a=1;a<arguments.length;a++){var O=arguments[a]!=null?arguments[a]:{};a%2?o(Object(O),!0).forEach(function(T){c(i,T,O[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(O)):o(Object(O)).forEach(function(T){Object.defineProperty(i,T,Object.getOwnPropertyDescriptor(O,T))})}return i}({},e)},revive:function(e){return e}}},l=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some(function(i){return String(Number.parseInt(i))!==i})&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach(function(i){var a=e[i];t[i]=a}),t}}},{sparseUndefined:{test:function(e,t){return e===void 0&&t.ownKeys===!1},replace:function(e){return 0},revive:function(e){}}}],y={undef:{test:function(e,t){return e===void 0&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new J.Undefined}}},v={StringObject:{test:function(e){return J.toStringTag(e)==="String"&&s(e)==="object"},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(e){return J.toStringTag(e)==="Boolean"&&s(e)==="object"},replace:function(e){return!!e},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(e){return J.toStringTag(e)==="Number"&&s(e)==="object"},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},h=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],A={date:{test:function(e){return J.toStringTag(e)==="Date"},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return e==="NaN"?new Date(Number.NaN):new Date(e)}}},Y={regexp:{test:function(e){return J.toStringTag(e)==="RegExp"},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,i=e.flags;return new RegExp(t,i)}}},X={map:{test:function(e){return J.toStringTag(e)==="Map"},replace:function(e){return N(e.entries())},revive:function(e){return new Map(e)}}},Q={set:{test:function(e){return J.toStringTag(e)==="Set"},replace:function(e){return N(e.values())},revive:function(e){return new Set(e)}}},j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Te=new Uint8Array(256),Le=0;Le<j.length;Le++)Te[j.charCodeAt(Le)]=Le;var Fe=function(e,t,i){i==null&&(i=e.byteLength);for(var a=new Uint8Array(e,t||0,i),O=a.length,T="",k=0;k<O;k+=3)T+=j[a[k]>>2],T+=j[(3&a[k])<<4|a[k+1]>>4],T+=j[(15&a[k+1])<<2|a[k+2]>>6],T+=j[63&a[k+2]];return O%3==2?T=T.slice(0,-1)+"=":O%3==1&&(T=T.slice(0,-2)+"=="),T},Ye=function(e){var t,i,a,O,T=e.length,k=.75*e.length,_=0;e[e.length-1]==="="&&(k--,e[e.length-2]==="="&&k--);for(var U=new ArrayBuffer(k),q=new Uint8Array(U),H=0;H<T;H+=4)t=Te[e.charCodeAt(H)],i=Te[e.charCodeAt(H+1)],a=Te[e.charCodeAt(H+2)],O=Te[e.charCodeAt(H+3)],q[_++]=t<<2|i>>4,q[_++]=(15&i)<<4|a>>2,q[_++]=(3&a)<<6|63&O;return U},qe={arraybuffer:{test:function(e){return J.toStringTag(e)==="ArrayBuffer"},replace:function(e,t){t.buffers||(t.buffers=[]);var i=t.buffers.indexOf(e);return i>-1?{index:i}:(t.buffers.push(e),Fe(e))},revive:function(e,t){if(t.buffers||(t.buffers=[]),s(e)==="object")return t.buffers[e.index];var i=Ye(e);return t.buffers.push(i),i}}},Qe=typeof self>"u"?bt:self,De={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(n){var e=n,t=Qe[e];t&&(De[n.toLowerCase()]={test:function(a){return J.toStringTag(a)===e},replace:function(a,O){var T=a.buffer,k=a.byteOffset,_=a.length;O.buffers||(O.buffers=[]);var U=O.buffers.indexOf(T);return U>-1?{index:U,byteOffset:k,length:_}:(O.buffers.push(T),{encoded:Fe(T),byteOffset:k,length:_})},revive:function(a,O){O.buffers||(O.buffers=[]);var T,k=a.byteOffset,_=a.length,U=a.encoded,q=a.index;return"index"in a?T=O.buffers[q]:(T=Ye(U),O.buffers.push(T)),new t(T,k,_)}})});var ze={dataview:{test:function(e){return J.toStringTag(e)==="DataView"},replace:function(e,t){var i=e.buffer,a=e.byteOffset,O=e.byteLength;t.buffers||(t.buffers=[]);var T=t.buffers.indexOf(i);return T>-1?{index:T,byteOffset:a,byteLength:O}:(t.buffers.push(i),{encoded:Fe(i),byteOffset:a,byteLength:O})},revive:function(e,t){t.buffers||(t.buffers=[]);var i,a=e.byteOffset,O=e.byteLength,T=e.encoded,k=e.index;return"index"in e?i=t.buffers[k]:(i=Ye(T),t.buffers.push(i)),new DataView(i,a,O)}}},ge={IntlCollator:{test:function(e){return J.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return J.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return J.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function se(n){for(var e=new Uint8Array(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer}var ne={file:{test:function(e){return J.toStringTag(e)==="File"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,i=e.type,a=e.stringContents,O=e.lastModified;return new File([se(a)],t,{type:i,lastModified:O})},replaceAsync:function(e){return new J.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result,name:e.name,lastModified:e.lastModified})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}},ue={bigint:{test:function(e){return typeof e=="bigint"},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},we={bigintObject:{test:function(e){return s(e)==="object"&&J.hasConstructorOf(e,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},B={cryptokey:{test:function(e){return J.toStringTag(e)==="CryptoKey"&&e.extractable},replaceAsync:function(e){return new J.Promise(function(t,i){crypto.subtle.exportKey("jwk",e).catch(function(a){i(a)}).then(function(a){t({jwk:a,algorithm:e.algorithm,usages:e.usages})})})},revive:function(e){var t=e.jwk,i=e.algorithm,a=e.usages;return crypto.subtle.importKey("jwk",t,i,!0,a)}}};return[xe,y,l,v,h,A,Y,{imagedata:{test:function(e){return J.toStringTag(e)==="ImageData"},replace:function(e){return{array:N(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return J.toStringTag(e)==="ImageBitmap"||e&&e.dataset&&e.dataset.toStringTag==="ImageBitmap"},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,createImageBitmap(t)}}},ne,{file:ne.file,filelist:{test:function(e){return J.toStringTag(e)==="FileList"},replace:function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e.item(i);return t},revive:function(e){return new(function(){function t(){b(this,t),this._files=arguments[0],this.length=this._files.length}return function(a,O,T){return O&&m(a.prototype,O),T&&m(a,T),a}(t,[{key:"item",value:function(a){return this._files[a]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),t}())(e)}}},{blob:{test:function(e){return J.toStringTag(e)==="Blob"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,i=e.stringContents;return new Blob([se(i)],{type:t})},replaceAsync:function(e){return new J.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}}].concat(typeof Map=="function"?X:[],typeof Set=="function"?Q:[],typeof ArrayBuffer=="function"?qe:[],typeof Uint8Array=="function"?De:[],typeof DataView=="function"?ze:[],typeof Intl<"u"?ge:[],typeof crypto<"u"?B:[],typeof BigInt<"u"?[ue,we]:[])})}),ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ct=new Uint8Array(256);for(var pt=0;pt<ot.length;pt++)ct[ot.codePointAt(pt)]=pt;var gt=function(d,s,b){b==null&&(b=d.byteLength);for(var m=new Uint8Array(d,s||0,b),c=m.length,o="",N=0;N<c;N+=3)o+=ot[m[N]>>2],o+=ot[(m[N]&3)<<4|m[N+1]>>4],o+=ot[(m[N+1]&15)<<2|m[N+2]>>6],o+=ot[m[N+2]&63];return c%3===2?o=o.slice(0,-1)+"=":c%3===1&&(o=o.slice(0,-2)+"=="),o},Et=function(d){var s=d.length,b=d.length*.75,m=0,c,o,N,L;d[d.length-1]==="="&&(b--,d[d.length-2]==="="&&b--);for(var u=new ArrayBuffer(b),E=new Uint8Array(u),I=0;I<s;I+=4)c=ct[d.codePointAt(I)],o=ct[d.codePointAt(I+1)],N=ct[d.codePointAt(I+2)],L=ct[d.codePointAt(I+3)],E[m++]=c<<2|o>>4,E[m++]=(o&15)<<4|N>>2,E[m++]=(N&3)<<6|L&63;return u},Mt=typeof self>"u"?global:self,_t={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(g){var d=g,s=Mt[d];s&&(_t[g.toLowerCase()+"2"]={test:function(b){return dt.toStringTag(b)===d},replace:function(b){var m=b.buffer,c=b.byteOffset,o=b.length;return{buffer:m,byteOffset:c,length:o}},revive:function(b){var m=b.buffer,c=b.byteOffset,o=b.length;return new s(m,c,o)}})});var Yt={arraybuffer:{test:function(g){return dt.toStringTag(g)==="ArrayBuffer"},replace:function(g){return gt(g,0,g.byteLength)},revive:function(g){var d=Et(g);return d}}},Ge=new dt().register(Gt),qt="FileReaderSync"in self,yt=[],mt=0;Ge.register([Yt,_t,{blob2:{test:function(g){return dt.toStringTag(g)==="Blob"},replace:function(g){if(g.isClosed)throw new Error("The Blob is closed");if(qt){var d=Tt(g,"binary"),s=gt(d,0,d.byteLength);return{type:g.type,data:s}}else{yt.push(g);var b={type:g.type,data:{start:mt,end:mt+g.size}};return mt+=g.size,b}},finalize:function(g,d){g.data=gt(d,0,d.byteLength)},revive:function(g){var d=g.type,s=g.data;return new Blob([Et(s)],{type:d})}}}]);Ge.mustFinalize=function(){return yt.length>0};Ge.finalize=function(g){return tt(void 0,void 0,void 0,function(){var d,s,b,m,c,o,N,L,u,E;return Xe(this,function(I){switch(I.label){case 0:return[4,At(new Blob(yt),"binary")];case 1:if(d=I.sent(),g){for(s=0,b=g;s<b.length;s++)if(m=b[s],m.$types){c=m.$types,o=c.$,o&&(c=c.$);for(N in c)L=c[N],u=Ge.types[L],u&&u.finalize&&(E=Ue.getByKeyPath(m,o?"$."+N:N),u.finalize(E,d.slice(E.start,E.end)))}}return yt=[],[2]}})})};var zt=2e3;function Nt(g,d){return tt(this,void 0,void 0,function(){function s(){return tt(this,void 0,void 0,function(){var I,V,fe,K,D,z,_e,be,C,Ce;return Xe(this,function($){switch($.label){case 0:return[4,Promise.all(m.map(function(re){return re.count()}))];case 1:I=$.sent(),I.forEach(function(re,ie){return o[ie].rowCount=re}),E.totalRows=I.reduce(function(re,ie){return re+ie}),V=JSON.stringify(L,void 0,N?2:void 0),fe=V.lastIndexOf("]"),K=V.substring(0,fe),c.push(K),D=d.filter,z=d.transform,_e=function(re){var ie,Pe,f,r,w,p,te,M,ae,he,Se,ke;return Xe(this,function(Ne){switch(Ne.label){case 0:ie=g.table(re),Pe=ie.schema.primKey,f=!!Pe.keyPath,r=d.numRowsPerChunk||zt,w=f?{tableName:ie.name,inbound:!0,rows:[]}:{tableName:ie.name,inbound:!1,rows:[]},p=JSON.stringify(w,void 0,N?2:void 0),N&&(p=p.split(`
`).join(`
    `)),te=p.lastIndexOf("]"),c.push(p.substring(0,te)),M=null,ae=0,he=!0,Se=function(){var le,me,je,Me,J,y,de,xe,l,y;return Xe(this,function(v){switch(v.label){case 0:return u&&Ue.ignoreTransaction(function(){return u(E)}),le=M==null?ie.limit(r):ie.where(":id").above(M).limit(r),[4,le.toArray()];case 1:return me=v.sent(),me.length===0?[2,"break"]:(M!=null&&ae>0&&(c.push(","),N&&c.push(`
      `)),he=me.length===r,f?(je=D?me.filter(function(h){return D(re,h)}):me,Me=z?je.map(function(h){return z(re,h).value}):je,J=Me.map(function(h){return Ge.encapsulate(h)}),Ge.mustFinalize()?[4,Ue.waitFor(Ge.finalize(J))]:[3,3]):[3,4]);case 2:v.sent(),v.label=3;case 3:return y=JSON.stringify(J,void 0,N?2:void 0),N&&(y=y.split(`
`).join(`
      `)),c.push(new Blob([y.substring(1,y.length-1)])),ae=Me.length,M=me.length>0?Ue.getByKeyPath(me[me.length-1],Pe.keyPath):null,[3,8];case 4:return[4,le.primaryKeys()];case 5:return de=v.sent(),xe=de.map(function(h,A){return[h,me[A]]}),D&&(xe=xe.filter(function(h){var A=h[0],Y=h[1];return D(re,Y,A)})),z&&(xe=xe.map(function(h){var A=h[0],Y=h[1],X=z(re,Y,A);return[X.key,X.value]})),l=xe.map(function(h){return Ge.encapsulate(h)}),Ge.mustFinalize()?[4,Ue.waitFor(Ge.finalize(l))]:[3,7];case 6:v.sent(),v.label=7;case 7:y=JSON.stringify(l,void 0,N?2:void 0),N&&(y=y.split(`
`).join(`
      `)),c.push(new Blob([y.substring(1,y.length-1)])),ae=xe.length,M=de.length>0?de[de.length-1]:null,v.label=8;case 8:return E.completedRows+=me.length,[2]}})},Ne.label=1;case 1:return he?[5,Se()]:[3,3];case 2:return ke=Ne.sent(),ke==="break"?[3,3]:[3,1];case 3:return c.push(p.substr(te)),E.completedTables+=1,E.completedTables<E.totalTables&&c.push(","),[2]}})},be=0,C=o,$.label=2;case 2:return be<C.length?(Ce=C[be].name,[5,_e(Ce)]):[3,5];case 3:$.sent(),$.label=4;case 4:return be++,[3,2];case 5:return c.push(V.substr(fe)),E.done=!0,u&&Ue.ignoreTransaction(function(){return u(E)}),[2]}})})}var b,m,c,o,N,L,u,E;return Xe(this,function(I){switch(I.label){case 0:d=d||{},b=d.skipTables?d.skipTables:[],m=g.tables.filter(function(V){return!b.includes(V.name)}),c=[],o=m.map(function(V){return{name:V.name,schema:Jt(V),rowCount:0}}),N=d.prettyJson,L={formatName:"dexie",formatVersion:1,data:{databaseName:g.name,databaseVersion:g.verno,tables:o,data:[]}},u=d.progressCallback,E={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:o.length},I.label=1;case 1:return I.trys.push([1,,6,7]),d.noTransaction?[4,s()]:[3,3];case 2:return I.sent(),[3,5];case 3:return[4,g.transaction("r",g.tables,s)];case 4:I.sent(),I.label=5;case 5:return[3,7];case 6:return Ge.finalize(),[7];case 7:return[2,new Blob(c,{type:"text/json"})]}})})}var Ht=1,Wt={Stream:function(){}},Xt=wt(function(g,d){(function(s){var b=typeof process=="object"&&process.env?process.env:self;s.parser=function(f){return new fe(f)},s.CParser=fe,s.CStream=D,s.createStream=K,s.MAX_BUFFER_LENGTH=10*1024*1024,s.DEBUG=b.CDEBUG==="debug",s.INFO=b.CDEBUG==="debug"||b.CDEBUG==="info",s.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var m={textNode:void 0,numberNode:""},c=s.EVENTS.filter(function(f){return f!=="error"&&f!=="end"}),o=0,N;s.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++};for(var L in s.STATE)s.STATE[s.STATE[L]]=L;o=s.STATE;const u={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(f){function r(){this.__proto__=f}return r.prototype=f,new r}),Object.getPrototypeOf||(Object.getPrototypeOf=function(f){return f.__proto__}),Object.keys||(Object.keys=function(f){var r=[];for(var w in f)f.hasOwnProperty(w)&&r.push(w);return r});function E(f){var r=Math.max(s.MAX_BUFFER_LENGTH,10),w=0;for(var p in m){var te=f[p]===void 0?0:f[p].length;if(te>r)switch(p){case"text":closeText(f);break;default:$(f,"Max buffer length exceeded: "+p)}w=Math.max(w,te)}f.bufferCheckPosition=s.MAX_BUFFER_LENGTH-w+f.position}function I(f){for(var r in m)f[r]=m[r]}var V=/[\\"\n]/g;function fe(f){if(!(this instanceof fe))return new fe(f);var r=this;I(r),r.bufferCheckPosition=s.MAX_BUFFER_LENGTH,r.q=r.c=r.p="",r.opt=f||{},r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.state=o.BEGIN,r.stack=new Array,r.position=r.column=0,r.line=1,r.slashed=!1,r.unicodeI=0,r.unicodeS=null,r.depth=0,z(r,"onready")}fe.prototype={end:function(){re(this)},write:Pe,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{N=Wt.Stream}catch{N=function(){}}function K(f){return new D(f)}function D(f){if(!(this instanceof D))return new D(f);this._parser=new fe(f),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var r=this;N.apply(r),this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(w){r.emit("error",w),r._parser.error=null},c.forEach(function(w){Object.defineProperty(r,"on"+w,{get:function(){return r._parser["on"+w]},set:function(p){if(!p)return r.removeAllListeners(w),r._parser["on"+w]=p,p;r.on(w,p)},enumerable:!0,configurable:!1})})}D.prototype=Object.create(N.prototype,{constructor:{value:D}}),D.prototype.write=function(f){f=new Buffer(f);for(var r=0;r<f.length;r++){var w=f[r];if(this.bytes_remaining>0){for(var p=0;p<this.bytes_remaining;p++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+p]=f[p];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,r=r+p-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&w>=128)if(w>=194&&w<=223&&(this.bytes_in_sequence=2),w>=224&&w<=239&&(this.bytes_in_sequence=3),w>=240&&w<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+r>f.length){for(var te=0;te<=f.length-1-r;te++)this.temp_buffs[this.bytes_in_sequence][te]=f[r+te];return this.bytes_remaining=r+this.bytes_in_sequence-f.length,!0}else{this.string=f.slice(r,r+this.bytes_in_sequence).toString(),r=r+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var M=r;M<f.length&&!(f[M]>=128);M++);this.string=f.slice(r,M).toString(),this._parser.write(this.string),this.emit("data",this.string),r=M-1}},D.prototype.end=function(f){return f&&f.length&&this._parser.write(f.toString()),this._parser.end(),!0},D.prototype.on=function(f,r){var w=this;return!w._parser["on"+f]&&c.indexOf(f)!==-1&&(w._parser["on"+f]=function(){var p=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);p.splice(0,0,f),w.emit.apply(w,p)}),N.prototype.on.call(w,f,r)},D.prototype.destroy=function(){I(this._parser),this.emit("close")};function z(f,r,w){s.INFO&&console.log("-- emit",r,w),f[r]&&f[r](w)}function _e(f,r,w){be(f),z(f,r,w)}function be(f,r){f.textNode=Ce(f.opt,f.textNode),f.textNode!==void 0&&z(f,r||"onvalue",f.textNode),f.textNode=void 0}function C(f){f.numberNode&&z(f,"onvalue",parseFloat(f.numberNode)),f.numberNode=""}function Ce(f,r){return r===void 0||(f.trim&&(r=r.trim()),f.normalize&&(r=r.replace(/\s+/g," "))),r}function $(f,r){return be(f),r+=`
Line: `+f.line+`
Column: `+f.column+`
Char: `+f.c,r=new Error(r),f.error=r,z(f,"onerror",r),f}function re(f){return(f.state!==o.VALUE||f.depth!==0)&&$(f,"Unexpected end"),be(f),f.c="",f.closed=!0,z(f,"onend"),fe.call(f,f.opt),f}function ie(f){return f===u.carriageReturn||f===u.lineFeed||f===u.space||f===u.tab}function Pe(f){var r=this;if(this.error)throw this.error;if(r.closed)return $(r,"Cannot write after close. Assign an onready handler.");if(f===null)return re(r);var w=0,p=f.charCodeAt(0),te=r.p;for(s.DEBUG&&console.log("write -> ["+f+"]");p&&(te=p,r.c=p=f.charCodeAt(w++),te!==p?r.p=te:te=r.p,!!p);)switch(s.DEBUG&&console.log(w,p,s.STATE[r.state]),r.position++,p===u.lineFeed?(r.line++,r.column=0):r.column++,r.state){case o.BEGIN:p===u.openBrace?r.state=o.OPEN_OBJECT:p===u.openBracket?r.state=o.OPEN_ARRAY:ie(p)||$(r,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(ie(p))continue;if(r.state===o.OPEN_KEY)r.stack.push(o.CLOSE_KEY);else if(p===u.closeBrace){z(r,"onopenobject"),this.depth++,z(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_OBJECT);p===u.doubleQuote?r.state=o.STRING:$(r,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(ie(p))continue;r.state,o.CLOSE_KEY,p===u.colon?(r.state===o.CLOSE_OBJECT?(r.stack.push(o.CLOSE_OBJECT),be(r,"onopenobject"),this.depth++):be(r,"onkey"),r.state=o.VALUE):p===u.closeBrace?(_e(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE):p===u.comma?(r.state===o.CLOSE_OBJECT&&r.stack.push(o.CLOSE_OBJECT),be(r),r.state=o.OPEN_KEY):$(r,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(ie(p))continue;if(r.state===o.OPEN_ARRAY)if(z(r,"onopenarray"),this.depth++,r.state=o.VALUE,p===u.closeBracket){z(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_ARRAY);p===u.doubleQuote?r.state=o.STRING:p===u.openBrace?r.state=o.OPEN_OBJECT:p===u.openBracket?r.state=o.OPEN_ARRAY:p===u.t?r.state=o.TRUE:p===u.f?r.state=o.FALSE:p===u.n?r.state=o.NULL:p===u.minus?r.numberNode+="-":u._0<=p&&p<=u._9?(r.numberNode+=String.fromCharCode(p),r.state=o.NUMBER_DIGIT):$(r,"Bad value");continue;case o.CLOSE_ARRAY:if(p===u.comma)r.stack.push(o.CLOSE_ARRAY),be(r,"onvalue"),r.state=o.VALUE;else if(p===u.closeBracket)_e(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;else{if(ie(p))continue;$(r,"Bad array")}continue;case o.STRING:r.textNode===void 0&&(r.textNode="");var M=w-1,ae=r.slashed,he=r.unicodeI;e:for(;;){for(s.DEBUG&&console.log(w,p,s.STATE[r.state],ae);he>0;)if(r.unicodeS+=String.fromCharCode(p),p=f.charCodeAt(w++),r.position++,he===4?(r.textNode+=String.fromCharCode(parseInt(r.unicodeS,16)),he=0,M=w-1):he++,!p)break e;if(p===u.doubleQuote&&!ae){r.state=r.stack.pop()||o.VALUE,r.textNode+=f.substring(M,w-1),r.position+=w-1-M;break}if(p===u.backslash&&!ae&&(ae=!0,r.textNode+=f.substring(M,w-1),r.position+=w-1-M,p=f.charCodeAt(w++),r.position++,!p))break;if(ae){if(ae=!1,p===u.n?r.textNode+=`
`:p===u.r?r.textNode+="\r":p===u.t?r.textNode+="	":p===u.f?r.textNode+="\f":p===u.b?r.textNode+="\b":p===u.u?(he=1,r.unicodeS=""):r.textNode+=String.fromCharCode(p),p=f.charCodeAt(w++),r.position++,M=w-1,p)continue;break}V.lastIndex=w;var Se=V.exec(f);if(Se===null){w=f.length+1,r.textNode+=f.substring(M,w-1),r.position+=w-1-M;break}if(w=Se.index+1,p=f.charCodeAt(Se.index),!p){r.textNode+=f.substring(M,w-1),r.position+=w-1-M;break}}r.slashed=ae,r.unicodeI=he;continue;case o.TRUE:p===u.r?r.state=o.TRUE2:$(r,"Invalid true started with t"+p);continue;case o.TRUE2:p===u.u?r.state=o.TRUE3:$(r,"Invalid true started with tr"+p);continue;case o.TRUE3:p===u.e?(z(r,"onvalue",!0),r.state=r.stack.pop()||o.VALUE):$(r,"Invalid true started with tru"+p);continue;case o.FALSE:p===u.a?r.state=o.FALSE2:$(r,"Invalid false started with f"+p);continue;case o.FALSE2:p===u.l?r.state=o.FALSE3:$(r,"Invalid false started with fa"+p);continue;case o.FALSE3:p===u.s?r.state=o.FALSE4:$(r,"Invalid false started with fal"+p);continue;case o.FALSE4:p===u.e?(z(r,"onvalue",!1),r.state=r.stack.pop()||o.VALUE):$(r,"Invalid false started with fals"+p);continue;case o.NULL:p===u.u?r.state=o.NULL2:$(r,"Invalid null started with n"+p);continue;case o.NULL2:p===u.l?r.state=o.NULL3:$(r,"Invalid null started with nu"+p);continue;case o.NULL3:p===u.l?(z(r,"onvalue",null),r.state=r.stack.pop()||o.VALUE):$(r,"Invalid null started with nul"+p);continue;case o.NUMBER_DECIMAL_POINT:p===u.period?(r.numberNode+=".",r.state=o.NUMBER_DIGIT):$(r,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:u._0<=p&&p<=u._9?r.numberNode+=String.fromCharCode(p):p===u.period?(r.numberNode.indexOf(".")!==-1&&$(r,"Invalid number has two dots"),r.numberNode+="."):p===u.e||p===u.E?((r.numberNode.indexOf("e")!==-1||r.numberNode.indexOf("E")!==-1)&&$(r,"Invalid number has two exponential"),r.numberNode+="e"):p===u.plus||p===u.minus?(te===u.e||te===u.E||$(r,"Invalid symbol in number"),r.numberNode+=String.fromCharCode(p)):(C(r),w--,r.state=r.stack.pop()||o.VALUE);continue;default:$(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&E(r),r}})(d)});function Qt(g){var d=0,s=Zt(!0),b={pullAsync:function(m){return tt(this,void 0,void 0,function(){var c,o,N;return Xe(this,function(L){switch(L.label){case 0:return c=g.slice(d,d+m),d+=m,[4,At(c,"text")];case 1:return o=L.sent(),N=s.write(o),b.result=N||{},[2,N]}})})},pullSync:function(m){var c=g.slice(d,d+m);d+=m;var o=Tt(c,"text"),N=s.write(o);return b.result=N||{},N},done:function(){return s.done()},eof:function(){return d>=g.size},result:{}};return b}function Zt(g){var d=Xt.parser(),s=0,b,m=[],c,o,N=!1,L=!1;return d.onopenobject=function(u){var E={};E.incomplete=!0,b||(b=E),c&&(m.push([o,c,L]),g&&(L?c.push(E):c[o]=E)),c=E,o=u,L=!1,++s},d.onkey=function(u){return o=u},d.onvalue=function(u){return L?c.push(u):c[o]=u},d.oncloseobject=function(){var u;if(delete c.incomplete,o=null,--s===0)N=!0;else{var E=c;u=m.pop(),o=u[0],c=u[1],L=u[2],g||(L?c.push(E):c[o]=E)}},d.onopenarray=function(){var u=[];u.incomplete=!0,b||(b=u),c&&(m.push([o,c,L]),g&&(L?c.push(u):c[o]=u)),c=u,L=!0,o=null,++s},d.onclosearray=function(){var u;if(delete c.incomplete,o=null,--s===0)N=!0;else{var E=c;u=m.pop(),o=u[0],c=u[1],L=u[2],g||(L?c.push(E):c[o]=E)}},{write:function(u){return d.write(u),b},done:function(){return N}}}var Ct=1024;function Pt(g,d){return tt(this,void 0,void 0,function(){var s,b,m,c;return Xe(this,function(o){switch(o.label){case 0:return d=d||{},s=d.chunkSizeBytes||Ct*1024,[4,It(g,s)];case 1:return b=o.sent(),m=b.result.data,c=new Ue(m.databaseName),c.version(m.databaseVersion).stores(Vt(m)),[4,Bt(c,b,d)];case 2:return o.sent(),[2,c]}})})}function Bt(g,d,s){return tt(this,void 0,void 0,function(){function b(){return tt(this,void 0,void 0,function(){var D,z,_e,be,C;return Xe(this,function(Ce){switch(Ce.label){case 0:D=function($){var re,ie,Pe,f,r,w,p,te,M,ae,he,Se,ke;return Xe(this,function(Ne){switch(Ne.label){case 0:if(u.includes($.tableName))return[2,"continue"];if(!$.rows)return[2,"break"];if(!$.rows.incomplete&&$.rows.length===0)return[2,"continue"];if(E&&Ue.ignoreTransaction(function(){return E(I)}),re=$.tableName,ie=g.table(re),Pe=L.tables.filter(function(le){return le.name===re})[0].schema,!ie){if(s.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat($.tableName," is missing in installed database"))}if(!s.acceptChangedPrimaryKey&&Pe.split(",")[0]!=ie.schema.primKey.src)throw new Error("Primary key differs for table ".concat($.tableName,". "));for(f=$.rows,r=[],w=0;w<f.length&&(p=f[w],!p.incomplete);w++)r.push(Ge.revive(p));return te=s.filter,M=s.transform,ae=te?$.inbound?r.filter(function(le){return te(re,le)}):r.filter(function(le){var me=le[0],je=le[1];return te(re,je,me)}):r,M&&(ae=ae.map($.inbound?function(le){return M(re,le).value}:function(le){var me=le[0],je=le[1],Me=M(re,je,me);return[Me.key,Me.value]})),he=$.inbound?[void 0,ae]:[ae.map(function(le){return le[0]}),r.map(function(le){return le[1]})],Se=he[0],ke=he[1],s.overwriteValues?[4,ie.bulkPut(ke,Se)]:[3,2];case 1:return Ne.sent(),[3,4];case 2:return[4,ie.bulkAdd(ke,Se)];case 3:Ne.sent(),Ne.label=4;case 4:return I.completedRows+=r.length,r.incomplete||(I.completedTables+=1),f.splice(0,r.length),[2]}})},z=0,_e=L.data,Ce.label=1;case 1:return z<_e.length?(be=_e[z],[5,D(be)]):[3,4];case 2:if(C=Ce.sent(),C==="break")return[3,4];Ce.label=3;case 3:return z++,[3,1];case 4:for(;L.data.length>0&&L.data[0].rows&&!L.data[0].rows.incomplete;)L.data.splice(0,1);return!c.done()&&!c.eof()?N?(c.pullSync(m),[3,7]):[3,5]:[3,8];case 5:return[4,Ue.waitFor(c.pullAsync(m))];case 6:Ce.sent(),Ce.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var m,c,o,N,L,u,E,I,V,fe,K;return Xe(this,function(D){switch(D.label){case 0:return s=s||{},m=s.chunkSizeBytes||Ct*1024,[4,It(d,m)];case 1:if(c=D.sent(),o=c.result,N="FileReaderSync"in self,L=o.data,u=s.skipTables?s.skipTables:[],!s.acceptNameDiff&&g.name!==L.databaseName)throw new Error("Name differs. Current database name is ".concat(g.name," but export is ").concat(L.databaseName));if(!s.acceptVersionDiff&&g.verno!==L.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(g.verno," but export is ").concat(L.databaseVersion));if(E=s.progressCallback,I={done:!1,completedRows:0,completedTables:0,totalRows:L.tables.reduce(function(z,_e){return z+_e.rowCount},0),totalTables:L.tables.length},E&&Ue.ignoreTransaction(function(){return E(I)}),!s.clearTablesBeforeImport)return[3,5];V=0,fe=g.tables,D.label=2;case 2:return V<fe.length?(K=fe[V],u.includes(K.name)?[3,4]:[4,K.clear()]):[3,5];case 3:D.sent(),D.label=4;case 4:return V++,[3,2];case 5:return s.noTransaction?[4,b()]:[3,7];case 6:return D.sent(),[3,9];case 7:return[4,g.transaction("rw",g.tables,b)];case 8:D.sent(),D.label=9;case 9:return I.done=!0,E&&Ue.ignoreTransaction(function(){return E(I)}),[2]}})})}function It(g,d){return tt(this,void 0,void 0,function(){var s,b;return Xe(this,function(m){switch(m.label){case 0:s="slice"in g?Qt(g):g,m.label=1;case 1:return s.eof()?[3,3]:[4,s.pullAsync(d)];case 2:return m.sent(),s.result.data&&s.result.data.data?[3,3]:[3,1];case 3:if(b=s.result,!b||b.formatName!="dexie")throw new Error("Given file is not a dexie export");if(b.formatVersion>Ht)throw new Error("Format version ".concat(b.formatVersion," not supported"));if(!b.data)throw new Error("No data in export file");if(!b.data.databaseName)throw new Error("Missing databaseName in export file");if(!b.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!b.data.tables)throw new Error("Missing tables in export file");return[2,s]}})})}Ue.prototype.export=function(g){return Nt(this,g)};Ue.prototype.import=function(g,d){return Bt(this,g,d)};Ue.import=function(g,d){return Pt(g,d)};class en{exportJson(){return Nt(rt,{prettyJson:!0})}async importJson(d){return await rt.delete(),await rt.open(),Pt(d)}}const tn={class:"container is-padded-mobile"},nn={class:"utilities-buttons mb-3"},rn={key:0,class:"file is-primary is-inline-block"},an={class:"file-label"},on={key:1,class:"button is-primary is-loading is-disabled"},sn={class:"utilities-buttons"},un={key:0,class:"file is-primary is-inline-block"},cn={class:"file-label"},fn={key:1,class:"button is-primary is-loading is-disabled"},ln={class:"destructive-buttons"},vn=xt({__name:"Utils",setup(g){const d=new $t,s=new en,b=new St,m=Ot(!1),c=Ot(!1),o=async()=>{await rt.delete(),await rt.open(),m.value=!1},N=async()=>{const I=await b.index(!0);d.downloadGamesCsv(I)},L=I=>{var K;const fe=(K=I.target.files)==null?void 0:K[0];if(fe){const D=new FileReader;D.onload=async()=>{try{c.value=!0,await d.importGamesCsv(D.result),c.value=!1,window.alert("Games imported successfully")}catch(z){c.value=!1,window.alert(z)}},D.readAsText(fe)}},u=async()=>{const I=await s.exportJson(),V=document.createElement("a");V.setAttribute("href",window.URL.createObjectURL(I));const K=`vgamelibrary-${new Date().toISOString().split("T")[0]}.json`;V.setAttribute("download",K),document.body.appendChild(V),V.click()},E=async I=>{var K;const fe=(K=I.target.files)==null?void 0:K[0];if(fe){const D=new FileReader;D.readAsArrayBuffer(fe),D.onload=async()=>{try{c.value=!0;const z=new Blob([D.result]);await s.importJson(z),c.value=!1,window.alert("DB imported successfully")}catch(z){c.value=!1,window.alert(z)}}}};return(I,V)=>(at(),st(Ut,null,[Ae("div",tn,[V[4]||(V[4]=Ae("h2",{class:"title is-3"},"Export / Import",-1)),Ae("div",nn,[Ae("button",{class:"button is-primary mr-3",onClick:u},"Export JSON"),c.value?ut("",!0):(at(),st("div",rn,[Ae("label",an,[Ae("input",{class:"file-input",type:"file",name:"resume",accept:".json",onChange:E},null,32),V[2]||(V[2]=Ae("span",{class:"file-cta"},[Ae("span",{class:"file-label"},"Import JSON")],-1))])])),c.value?(at(),st("button",on)):ut("",!0)]),Ae("div",sn,[Ae("button",{class:"button is-primary mr-3",onClick:N},"Export CSV"),c.value?ut("",!0):(at(),st("div",un,[Ae("label",cn,[Ae("input",{class:"file-input",type:"file",name:"resume",accept:".csv",onChange:L},null,32),V[3]||(V[3]=Ae("span",{class:"file-cta"},[Ae("span",{class:"file-label"},"Import CSV")],-1))])])),c.value?(at(),st("button",fn)):ut("",!0)]),V[5]||(V[5]=Ae("h2",{class:"title is-3 mt-5"},"Destructive zone",-1)),Ae("div",ln,[Ae("button",{class:"button is-danger",onClick:V[0]||(V[0]=()=>m.value=!0)},"DELETE ALL")])]),m.value?(at(),Lt(jt,{key:0,title:"Delete all",confirmText:"Ok",cancelText:"Cancel",onCancelModal:V[1]||(V[1]=()=>m.value=!1),onConfirmModal:o},{default:Rt(()=>V[6]||(V[6]=[Ae("span",null,"Do you want to DELETE ALL DATA from the DB?",-1)])),_:1})):ut("",!0)],64))}});export{vn as default};
