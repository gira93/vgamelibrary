import{d as C,r as b,o as D,c as w,w as P,a as c,b as e,e as I,v as q,q as K,h as _,j as A,t as g,F as $,f as j,g as N,s as z,i as S,p as G,k as M,l as L,n as H,m as J}from"./index-0f5e497a.js";import{_ as R,P as U}from"./PlatformRepository-3abe7ed2.js";import{G as E}from"./GameRepository-4251035f.js";const Q={class:"field"},W={class:"control"},X={class:"field"},Y={class:"select is-fullwidth"},Z=["value"],ee=C({__name:"CreateEditGameModal",props:{gameEdit:{}},emits:["closeGameModal","saveGameModal"],setup(y,{emit:h}){const p=new E,d=new U,v=h,l=y,s=b({name:"",platformId:0}),a=b([]),t=async()=>{const{name:o,platformId:m}=s.value;if(o!=="")try{l.gameEdit&&l.gameEdit.id?await p.update(l.gameEdit.id,{name:o,platformId:m}):await p.create({name:o,platformId:m}),v("saveGameModal")}catch(f){window.alert(f)}},i=async()=>{a.value=await d.index()};return D(async()=>{var o;await i(),(o=a.value[0])!=null&&o.id&&(s.value.platformId=a.value[0].id),l.gameEdit&&(s.value={name:l.gameEdit.name,platformId:l.gameEdit.platformId})}),(o,m)=>(c(),w(R,{title:o.gameEdit?"Update game":"Add new game",confirmText:"Save",cancelText:"Cancel",onCancelModal:m[2]||(m[2]=f=>o.$emit("closeGameModal")),onConfirmModal:t},{default:P(()=>[e("form",{onSubmit:j(t,["prevent"])},[e("div",Q,[m[3]||(m[3]=e("label",{class:"label"},"Game name",-1)),e("div",W,[I(e("input",{"onUpdate:modelValue":m[0]||(m[0]=f=>s.value.name=f),class:"input",type:"text"},null,512),[[q,s.value.name]])])]),e("div",X,[m[4]||(m[4]=e("label",{class:"label"},"Platform",-1)),e("div",Y,[I(e("select",{"onUpdate:modelValue":m[1]||(m[1]=f=>s.value.platformId=f)},[(c(!0),_($,null,A(a.value,f=>(c(),_("option",{key:f.id,value:f.id},g(f.name),9,Z))),128))],512),[[K,s.value.platformId]])])])],32)]),_:1},8,["title"]))}}),te={key:0},se={key:1},le=C({__name:"DeleteGameModal",props:{selectedGames:{}},emits:["closeDeleteGameModal"],setup(y,{emit:h}){const p=new E,d=h,v=y,l=N(()=>v.selectedGames.length<=1),s=async()=>{const a=v.selectedGames.map(t=>t.id).filter(t=>!!t);await p.delete(a),d("closeDeleteGameModal")};return(a,t)=>(c(),w(R,{title:l.value?"Delete game":"Delete games",confirmText:"Ok",cancelText:"Cancel",onCancelModal:t[0]||(t[0]=i=>a.$emit("closeDeleteGameModal")),onConfirmModal:s},{default:P(()=>[l.value?(c(),_("span",te," Do you want to remove "+g(a.selectedGames[0].name)+"? ",1)):(c(),_("span",se,"Do you want to remove the selected "+g(a.selectedGames.length)+" games?",1))]),_:1},8,["title"]))}}),ae={class:"column is-12 columns"},oe={class:"field column is-2"},ne={class:"select is-fullwidth"},ie=["value"],de=["value"],me={class:"field column is-4"},re={class:"control"},ue=["value"],ce=C({__name:"GamesFilters",props:{platformId:{},gameName:{}},emits:["update:platformId","update:gameName","updateTrigger"],setup(y,{emit:h}){const p=new U,d=h,v=b([]),l=async()=>{v.value=await p.index()},s=()=>{d("update:gameName",""),d("update:platformId",null),d("updateTrigger")};return D(()=>{l()}),(a,t)=>(c(),_("div",ae,[e("div",oe,[t[5]||(t[5]=e("label",{class:"label"},"Platform",-1)),e("div",ne,[e("select",{value:a.platformId,onChange:t[0]||(t[0]=i=>a.$emit("updateTrigger")),onInput:t[1]||(t[1]=i=>{var o;return a.$emit("update:platformId",parseInt((o=i.target)==null?void 0:o.value))})},[t[4]||(t[4]=e("option",{value:null},"None",-1)),(c(!0),_($,null,A(v.value,i=>(c(),_("option",{key:i.id,value:i.id},g(i.name),9,de))),128))],40,ie)])]),e("div",me,[t[6]||(t[6]=e("label",{class:"label"},"Name",-1)),e("div",re,[e("input",{value:a.gameName,onInput:t[2]||(t[2]=i=>{var o;return a.$emit("update:gameName",(o=i.target)==null?void 0:o.value)}),class:"input",type:"text",onKeyup:t[3]||(t[3]=z(i=>a.$emit("updateTrigger"),["enter"]))},null,40,ue)])]),e("div",{class:"field column is-2"},[t[7]||(t[7]=e("label",{class:"label"},"Clear",-1)),e("button",{class:"button is-primary",onClick:s},"Clear")])]))}}),pe={class:"container is-padded-mobile"},ve={class:"columns is-multiline"},fe={class:"column is-12 has-text-right"},_e=["disabled"],ge={class:"column is-12"},he={key:0,class:"column is-12"},be={class:"custom-table table is-striped is-fullwidth"},ye={class:"custom-table__header-selection"},ke={class:"checkbox"},Me=["checked"],we={class:"checkbox"},$e=["value"],Ce={class:"is-block"},Ge={class:"is-hidden-desktop is-italic"},Ie={class:"is-hidden-touch"},Ne={class:"has-text-right"},De=["onClick"],Ae=["onClick"],Ee={class:"icon is-small"},xe=["onClick"],Oe=["onClick"],Te={class:"icon is-small"},Se={key:1,class:"column is-12"},Fe=C({__name:"Games",setup(y){const h=new E,p=S({isAddNewModalOpen:!1,isDeleteModalOpen:!1}),d=b([]),v=b([]),l=b([]),s=S({platformId:null,gameName:""}),a=N(()=>s.platformId!==null||s.gameName!==""),t=N(()=>d.value.length===0?!1:l.value.length===d.value.length),i=async()=>{const r=await h.index(!0,s.platformId?{platformId:s.platformId}:null);s.gameName!==""?d.value=r.filter(n=>new RegExp(s.gameName,"i").test(n.name)):d.value=r},o=r=>{r&&i(),v.value=[],p.isAddNewModalOpen=!1},m=r=>{v.value=[{...r}],p.isAddNewModalOpen=!0},f=r=>{v.value=[{...r}],p.isDeleteModalOpen=!0},F=()=>{v.value=d.value.filter(r=>r.id&&l.value.includes(r.id)),p.isDeleteModalOpen=!0},V=()=>{i(),v.value=[],l.value=[],p.isDeleteModalOpen=!1},B=()=>{t.value?l.value=[]:l.value=d.value.map(r=>r.id).filter(r=>!!r)};return D(()=>{i()}),(r,n)=>{const x=L("font-awesome-icon");return c(),_($,null,[e("div",pe,[e("div",ve,[e("div",fe,[e("button",{class:"button is-danger mr-3",onClick:F,disabled:l.value.length===0}," Delete selection ",8,_e),e("button",{class:"button is-primary",onClick:n[0]||(n[0]=()=>p.isAddNewModalOpen=!0)}," Add new ")]),G(ce,{platformId:s.platformId,"onUpdate:platformId":n[1]||(n[1]=u=>s.platformId=u),gameName:s.gameName,"onUpdate:gameName":n[2]||(n[2]=u=>s.gameName=u),onUpdateTrigger:i},null,8,["platformId","gameName"]),e("div",ge,"Total items: "+g(d.value.length),1),a.value?(c(),_("div",he,[e("table",be,[e("thead",null,[e("tr",null,[e("th",ye,[e("label",ke,[e("input",{type:"checkbox",checked:t.value,onChange:B},null,40,Me)])]),n[5]||(n[5]=e("th",null,"Game",-1)),n[6]||(n[6]=e("th",{class:"is-hidden-touch"},"Platform",-1)),n[7]||(n[7]=e("th",{class:"custom-table__header-actions has-text-right"},"Actions",-1))])]),e("tbody",null,[(c(!0),_($,null,A(d.value,u=>{var O,T;return c(),_("tr",{key:u.id,class:H({"is-selected":u.id&&l.value.includes(u.id)})},[e("td",null,[e("label",we,[I(e("input",{type:"checkbox",value:u.id,"onUpdate:modelValue":n[3]||(n[3]=k=>l.value=k)},null,8,$e),[[J,l.value]])])]),e("td",null,[e("span",Ce,g(u.name),1),e("span",Ge,g((O=u.platform)==null?void 0:O.name),1)]),e("td",Ie,g((T=u.platform)==null?void 0:T.name),1),e("td",Ne,[e("button",{class:"button is-primary is-small is-hidden-touch mr-3",onClick:k=>m(u)}," Edit ",8,De),e("button",{class:"button is-primary is-small mr-3 is-hidden-desktop",onClick:k=>m(u)},[e("span",Ee,[G(x,{icon:"fa-regular fa-pen-to-square"})])],8,Ae),e("button",{class:"button is-danger is-small is-hidden-touch",onClick:k=>f(u)}," Delete ",8,xe),e("button",{class:"button is-danger is-small is-hidden-desktop",onClick:k=>f(u)},[e("span",Te,[G(x,{icon:"fa-regular fa-trash-can"})])],8,Oe)])],2)}),128))])])])):M("",!0),a.value?M("",!0):(c(),_("div",Se,"Use filters to search for games"))])]),p.isAddNewModalOpen?(c(),w(ee,{key:0,gameEdit:v.value[0],onCloseGameModal:o,onSaveGameModal:n[4]||(n[4]=u=>o(!0))},null,8,["gameEdit"])):M("",!0),p.isDeleteModalOpen?(c(),w(le,{key:1,selectedGames:v.value,onCloseDeleteGameModal:V},null,8,["selectedGames"])):M("",!0)],64)}}});export{Fe as default};
